language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm i -g npm@5.7.1 # delete once 5.7.X is out of "pre-release"
  - npm ci             # faster, goes only from package-lock
before_script:
  - psql -c 'create database "boilermaker-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)

 before_deploy:
   - npm run build-client # make the bundle
   - rm -rf node_modules # omit from the tarball, since we skip cleanup
 deploy:
   skip_cleanup: true # prevents travis from deleting the build
   provider: heroku
   app: test-1804-deploy-sample # see README
   api_key:
    secure: "bEfbB50Gca5vIafpOVMFFM3FG9tdJPVz6qzY+g8J58HP2+ltfasOdRbW8Ym6kKqsEW8ae/0k100DuD6oR00Kpwz/gUwrR8gp1PYmtm5+7huN90gnfKhRgqX8mNTX3m6oaBZ0+rCLtn/j76J41Da3zn5IA5tKwnLV94AxR9sMcAOsi9wrLHabO+fttzSsKQsPA54EyEuRaBtGACLIkareeGF+8YFVBTMRax1mLYbcRmS81h45lUzg15NHcaxZ5fxYUMtCDLhtggl4v6rb264I0zPLL9w1ZOM3LLgZRDJNnchBiaTNbmZl88BbyOrR7HRQJLV0Nq2FQ4tftM77VAGb0QAlPkTzenRMI8vEdg2lkScOvOjDRug/Gjszf16N/uWVrajcFIoQ9eTd0SRLqzhq81tkWHXczYI7PYC/YFM5Q/b9sgUFLp2oBgrk8NEBcunDNmAcAqMXMvCGgkjKrtNcjITUgGKpRAwxITBTA/cDaSiz1Kf+Yh/uGx+I6518ROJ96Yut/PJUJWtlLTb6DNaJ8d6B0dRg91LPefPqGt43WeIFyV6CwhrPuXNSbal4MWPcDwcnpqexvqWb4NVyTgD4X13JawxRk94wXPeV3V+hIPE/9XLSB1pInQLSEnpSVlfxcQJtS7ksmjYXfauDelw+s6fhUJIRb180TABUVDRmqHg="
